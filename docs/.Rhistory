fast_str2int
?fast_str2int
head(index_df)
spec(index_df)
head(index_df)
index_df
ls()
input_f <-  "/run/media/nwknoblauch/Data/gwas_data/gwas_sumstats/ptb_gwas.h5"
chrom <- 21
chrom <- 21L
head(jdf)
chrom_df$offset
head(rjdf)
sum(duplicated(rjdf$rsid))
filter(rjdf,duplicated(rsid))
left_join(rjdf,(filter(rjdf,duplicated(rsid)) %>% distinct(rsid)))
inner_join(rjdf,(filter(rjdf,duplicated(rsid)) %>% distinct(rsid)))
head(tjdf)
head(tjdf) %>% pull(snp_struct
)
)
head(tjdf) %>% pull(snp_struct)
head(rjdf)
input_f <- "run/media/nwknoblauch/Data/gwas_data/gwas_sumstats/ptb_gwas.h5"
chrom <- 22
input_f <- "/run/media/nwknoblauch/Data/gwas_data/gwas_sumstats/ptb_gwas.h5"
head(chrom_df)
head(jdf)
chrom
schrom
schrom <- 22
chrom_df
head(jdf)
head(jdf)
head(jdf)
head(jdf)
arrange(jdf,subset) %>% head()
tail(jdf)
arrange(jdf,subset) %>% tail()
dir()
getwd()
setwd("../snakemake/")
ls()
input_f
index_f
snakemake
gwas_type
gwas_type
sel_cols
sel_cols
input_f
ls()
index_f
x <- "/run/media/nwknoblauch/Data/gwas_data/gwas_sumstats/hm3_index/ptb_gwas_hm_chr1.h5"
head(tdf)
sel_cols
)
index_f
head(index_df)
chrom_df
datasize <- chrom_df$datasize
offset <- chrom_df$offset
input_df <-   EigenH5::read_df_h5(filename = input_f,
                          datapath = "snp",
                            subcols = sel_cols,
                            offset = offset,
                            datasize = datasize)
chrom_df
chrom_df
head(index_df)
head(sel_cols)
head(jdf)
dim(jdf)
l2dir
ls()
q()
n
sumstat_h5f <- "/run/media/nwknoblauch/data/gwas_data/gwas_sumstats/fgd_gwas.h5"
chromlist <- 1:22
snplist <- glue::glue("/run/media/nwknoblauch/Data/1kg/1000G_EUR_Phase3_plink/1000G.EUR.QC.{chromlist}.bim")
snplist
sumstat_h5f
sumstat_h5f <- "/run/media/nwknoblauch/Data/gwas_data/gwas_sumstats/fgd_gwas.h5"
head(chrom_df)
snplist
read_plink_bim
traceback()
q()
n
sumstat_h5f <- "/run/media/nwknoblauch/Data/gwas_data/gwas_sumstats/fgd_gwas.h5"
chromlist <- 1:22
snplist <- glue::glue("/run/media/nwknoblauch/Data/1kg/1000G_EUR_Phase3_plink/1000G.EUR.QC.{chromlist}.bim")
ttdf <- read_plink_bim(snplist[19])
head(ttdf)
args(read_plink_bim)
bim_cols
ttdf <- read_plink_bim(snplist[19],cols=bim_cols(chrom=col_chromosome(prefix_chr=FALSE)))
head(ttdf
)
length(index_l)
chrom <- 19
offset <- chrom_df$offset[19]
datasize <- chrom_df$datasize[19]
chrom <- chrom_df$chrom[19]
snplist_l <- index_l[[19]]
head(snplist_l)
sel_cols
ls_h5(sumstat_h5f,"snp")
head(idf)
cdf <- match_ref_panel(idf,snplist_l)
head(cdf)
filter(cdf,is.na(index))
which.min(abs(positions(snplist_l)-254448))
snplist_l[58]
min(abs(positions(snplist_l)-381230))
min(abs(positions(snplist_l)-289895))
sum(is.na(cdf$index))
sum(!is.na(cdf$index))
head(idf)
summary(idf$locus)
2+2
q()n
q()
n
annof
region_l
length(region_l[[1]]
)
length(region_l[[2]])
sum(is.na(region_l[[1]]))
sum(is.na(region_l[[2]]))
chromlist <- 1:23
chromlist <- 1:22
chrom <- 19L
offset <- chrom_df$offset[19]
datasize <- chrom_df$datasize[19]
head(ret_df)
head(ret_df)
nrow(ret_df
)
nrow(idf)
filter(ret_df,`chip-seq-dec_down-H3K27ac_d`!=0)
snplist_l <- index_l[[19]]
chrom <- 19L
datasize <- chrom_df$datasize[19]
offset <- chrom_df$offset[19]
snplist_l <- index_l[[19]]
head(idf)
head(ret_df)
q()
n
